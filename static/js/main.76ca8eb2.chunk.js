(this.webpackJsonpyaniv=this.webpackJsonpyaniv||[]).push([[0],[,,,,,,,,,,,,function(e,r,n){},function(e,r,n){},function(e,r,n){},function(e,r,n){},function(e,r,n){"use strict";n.r(r);var t=n(0),a=n(1),c=n.n(a),s=n(6),i=n.n(s),l=(n(12),n(13),n(2)),d=n(3);var u=function(e){return Object(t.jsx)("div",{className:"card back",children:"*"})};var o=function(e){return Object(t.jsx)("div",{className:"text-green-600 font-bold",children:e.score})};var h=function(e){return Object(t.jsx)("div",{children:e.id})};var b=function(e){var r,n=[],a=Object(d.a)(e.player.hand);try{for(a.s();!(r=a.n()).done;){var c=r.value;n.push(Object(t.jsx)(u,{card:c},c))}}catch(s){a.e(s)}finally{a.f()}return Object(t.jsxs)("div",{className:"px-8",children:[Object(t.jsxs)("div",{className:"flex items-center justify-center py-3",children:[e.turn===e.player.turn?Object(t.jsx)("div",{className:"bg-yellow-300",children:Object(t.jsx)(h,{id:e.player.id})}):Object(t.jsx)("div",{className:"",children:Object(t.jsx)(h,{id:e.player.id})}),Object(t.jsx)("div",{className:"pl-2",children:Object(t.jsx)(o,{score:e.player.score})}),e.paused&&Object(t.jsx)("span",{className:"text-red-500 pl-2 font-bold",children:e.player.points})]}),Object(t.jsx)("div",{className:"-space-x-12 flex flex-wrap items-center playingCards faceImages simpleCards",children:n})]})};var f=function(e){for(var r=[],n=0;n<e.players.length;n++)0!==n&&r.push(Object(t.jsx)(b,{paused:e.paused,player:e.players[n],turn:e.turn},n));return Object(t.jsx)("div",{className:"flex flex-wrap content-center",children:r})},j=function(e,r){var n=e;return n+1>=r?n=0:n+=1,n},v=function(e){var r=Array.from(Array(13).keys()),n=Array.from({length:13},(function(e,r){return r+13})),t=Array.from({length:13},(function(e,r){return r+26})),a=Array.from({length:13},(function(e,r){return r+39})),c="",s=e;return r.includes(e)?c="H":n.includes(e)?(c="D",s-=13):t.includes(e)?(c="C",s-=26):a.includes(e)?(c="S",s-=39):[52,53].includes(e)&&(c="J",s="-1"),0===s?s="A":10===s?s="J":11===s?s="Q":12===s?s="K":-1===s?s=0:s++,{number:s,suit:c}},p=function(e){for(var r,n,t=e.length;0!==t;)n=Math.floor(Math.random()*t),r=e[t-=1],e[t]=e[n],e[n]=r;return e},x=function(e){var r=Array.from(Array(54).keys());r=p(r);for(var n=[],t=0;t<e;t++)n.push({id:"Player "+t,score:0,hand:c(5),turn:t,points:0,lastDrawPile:0});for(var a=0;a<n.length;a++)n[a].points=g(n[a].hand);function c(e){for(var n=[],t=0;t<e;t++)n.push(r.pop());return n}return{players:n,deck:r}},m=function(e,r){return Math.floor(Math.random()*r)+e},O={0:0,A:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:10,Q:10,K:10},g=function(e){for(var r=0,n=0;n<e.length;n++){var t=v(e[n]);r+=O[t.number]}return r},y=function(e,r,n){var t,a=function(e){for(var r=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0]],n={J:0,H:1,D:2,C:3,S:4},t={0:0,A:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:11,Q:12,K:13},a=0;a<e.length;a++){var c=v(e[a]),s=n[c.suit],i=t[c.number];r[s][i]++}return r}(e);switch(n){case 0:({cards:[e[m(0,e.length)]],drawPile:2});break;case 1:({cards:C(e,a),drawPile:2});break;case 2:var c=k(e);0===c.length&&(c=[e[m(0,e.length)]]),{cards:c,drawPile:2};break;default:({cards:[e[0]],drawPile:2})}var s=C(e,a),i=k(e),l=g(s),d=g(i);t=l>=d?s:i;var u=2;if(r.length>0){var o=r[r.length-1],h=v(o),b=O[h.number],f=e.filter((function(e){return t.indexOf(e)<0})),j=C(f=f.push(o),a),p=k(f);j.length>=2&&j.includes(o)?(console.log("set lengths match: "+j.length),u=1):p.length>=3&&j.includes(o)?(console.log("run lengths match: "+p.length),u=1):b<4&&(console.log("topCardValue match: "+b),u=1)}return{cards:t,drawPile:u}};function k(e){for(var r=[],n=[],t=[],a=[],c=[],s=0;s<e.length;s++){switch(v(e[s]).suit){case"H":r.push(e[s]);break;case"D":n.push(e[s]);break;case"C":t.push(e[s]);break;case"S":a.push(e[s]);break;case"J":c.push(e[s])}}var i=[r,n,t,a];i=i.sort((function(e,r){return r.length-e.length}));for(var l=[],d=0;d<i.length;d++){var u=i[d].concat(c);if(N(i[d])){l=i[d];break}if(1===c.length&&N(u)){l=u;break}if(2===c.length&&N(i[d].concat(c[0]))){l=i[d].concat(c[0]);break}if(2===c.length&&N(u)){l=u;break}}if(l.length<=1){var o=v(e[0]),h=O[o.number];l=[e[0]];for(var b=1;b<e.length;b++){var f=v(e[b]),j=O[f.number];j>h&&(h=j,l=[e[b]])}}return l}function C(e,r){for(var n=r.reduce((function(e,r){return e.map((function(e,n){return r[n]+e}))})),t=Math.max.apply(Math,n),a=0,c=0;c<n.length;c++)n[c]===t&&(a=c);for(var s=[],i={0:0,A:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:11,Q:12,K:13},l=0;l<e.length;l++)i[v(e[l]).number]===a&&s.push(e[l]);return s}var N=function(e){for(var r={0:0,A:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:11,Q:12,K:13},n=[],t=0;t<e.length;t++){var a=v(e[t]);a.number=r[a.number],n.push(a)}var c=!1,s=!1;n.length>=2&&(c=function(e){for(var r=!0,n=e[0].number,t=0;t<e.length;t++)if(0!==e[t].number&&e[t].number!==n){r=!1;break}return r}(n)),n.length>=3&&(s=function(e){for(var r=!0,n="",t=0;t<e.length;t++)if("J"!==e[t].suit){n=e[t].suit;break}for(var a=[],c=0,s=0;s<e.length;s++)if("J"===e[s].suit)c++;else{if(e[s].suit!==n&&"J"!==e[s].suit){r=!1;break}a.push(e[s].number)}a=a.sort((function(e,r){return e-r}));for(var i=1;i<a.length;i++){var l=a[i]-a[i-1];if(l>=4||3===l&&c<2||2===l&&c<1){r=!1;break}}return r}(n));var i=!1;return(1===e.length||c||s)&&(i=!0),i};var w=function(e){var r=Object(a.useState)(!1),n=Object(l.a)(r,2),c=n[0],s=n[1];function i(){e.paused||(s(!c),e.onCardClick(e.card))}var d,u,o=v(e.card),h={H:"hearts",D:"diams",C:"clubs",S:"spades",J:"joker"}[o.suit],b="selectable cursor-pointer card rank-"+o.number+" "+h;switch(52===e.card?b+=" little":53===e.card&&(b+=" big"),b=b.toLowerCase(),o.suit){case"H":d=Object(t.jsx)("div",{className:"suit",children:"\u2665"});break;case"D":d=Object(t.jsx)("div",{className:"suit",children:"\u2666"});break;case"C":d=Object(t.jsx)("div",{className:"suit",children:"\u2663"});break;case"S":d=Object(t.jsx)("div",{className:"suit",children:"\u2660"});break;case"J":d=Object(t.jsx)("div",{className:"suit",children:"Joker"})}return u=c?Object(t.jsx)("strong",{children:Object(t.jsxs)("label",{onClick:function(){return i()},className:b,children:[Object(t.jsx)("div",{className:"rank",children:o.number}),d]})}):Object(t.jsxs)("div",{onClick:function(){return i()},className:b,children:[Object(t.jsx)("div",{className:"rank",children:o.number}),d]}),Object(t.jsx)("div",{className:"playingCards faceImages simpleCards",children:u})};var S=function(e){var r=[];function n(r){e.onCardClick(r)}var a,c=Object(d.a)(e.player.hand);try{for(c.s();!(a=c.n()).done;){var s=a.value;r.push(Object(t.jsx)(w,{paused:e.paused,card:s,onCardClick:function(e){return n(e)}},s))}}catch(i){c.e(i)}finally{c.f()}return Object(t.jsx)("div",{className:"space-x-3 flex items-center justify-center flex-wrap",children:r})};var P=function(){return Object(t.jsx)("div",{children:Object(t.jsx)("button",{className:"px-4 py-1 rounded-md text-white bg-purple-500 hover:bg-purple-600 focus:outline-none",children:"Yaniv"})})};var J=function(){return Object(t.jsx)("div",{children:Object(t.jsx)("button",{className:"px-4 py-1 rounded-md text-white bg-blue-500 hover:bg-blue-600 focus:outline-none",children:"Ready"})})};var D=function(e){return Object(t.jsxs)("div",{className:"flex flex-col",children:[Object(t.jsx)("div",{className:"",children:Object(t.jsx)(S,{selectedCards:e.selectedCards,paused:e.paused,player:e.player,onCardClick:function(r){return function(r){var n=e.selectedCards;n.includes(r)?n.splice(n.indexOf(r),1):n.push(r),e.onCardClick(n,r)}(r)}})}),Object(t.jsxs)("div",{className:"flex items-center justify-center pt-6",children:[e.turn===e.player.turn?Object(t.jsx)("div",{className:"bg-yellow-300",children:Object(t.jsx)(h,{id:e.player.id})}):Object(t.jsx)("div",{className:"",children:Object(t.jsx)(h,{id:e.player.id})}),Object(t.jsx)("span",{className:"pl-2",children:Object(t.jsx)(o,{score:e.player.score})}),e.paused&&Object(t.jsx)("span",{className:"text-red-500 font-bold pl-2",children:e.player.points}),g(e.player.hand)<=5&&!e.paused&&Object(t.jsx)("div",{onClick:function(){e.onYanivClick()},className:"pl-4",children:Object(t.jsx)(P,{})}),e.paused&&Object(t.jsx)("div",{onClick:function(){e.onReadyClick()},className:"pl-4",children:Object(t.jsx)(J,{})})]}),Object(t.jsx)("div",{className:"pt-6 text-red-500",children:e.errorMessage})]})};var A=function(e){function r(){e.paused||void 0===e.discardPile||0===e.discardPile.length||e.onDiscardPileClick()}var n,a,c,s,i;if(e.discardPile.length>0){var l=e.lastPlayedCards,d={H:"hearts",D:"diams",C:"clubs",S:"spades",J:"joker"};i=[];for(var u=0;u<l.length;u++){var o=v(l[u]);switch(n=d[o.suit],a="discard card rank-"+o.number+" "+n,52===l[u]?a+=" little":53===l[u]&&(a+=" big"),a=a.toLowerCase(),o.suit){case"H":c=Object(t.jsx)("div",{className:"suit",children:"\u2665"});break;case"D":c=Object(t.jsx)("div",{className:"suit",children:"\u2666"});break;case"C":c=Object(t.jsx)("div",{className:"suit",children:"\u2663"});break;case"S":c=Object(t.jsx)("div",{className:"suit",children:"\u2660"});break;case"J":c=Object(t.jsx)("div",{className:"suit",children:"Joker"})}u===l.length-1?(a+=" selectable cursor-pointer",s=Object(t.jsxs)("div",{onClick:r,className:a,children:[Object(t.jsx)("div",{className:"rank",children:o.number}),c]},l[u])):s=Object(t.jsxs)("div",{className:a,children:[Object(t.jsx)("div",{className:"rank",children:o.number}),c]},l[u]),i.push(s)}}else i=Object(t.jsx)("div",{className:"flex items-center justify-center text-sm w-16 h-20 mx-3 rounded-md bg-white border-4 border-gray-200 focus:outline-none",children:"discard pile"});return Object(t.jsx)("div",{className:"-space-x-12",children:i})};var M=function(e){function r(){e.onDrawStackClick()}var n;return n=e.drawStack.length>0?Object(t.jsx)("div",{onClick:r,className:"selectable cursor-pointer card back",children:"*"}):Object(t.jsx)("div",{onClick:r,className:"selectable cursor-pointer text-md flex items-center justify-center w-16 h-20 mx-3 rounded-md bg-white border-4 border-gray-200 hover:border-gray-300 focus:outline-none",children:"shuffle"}),Object(t.jsx)("div",{children:n})};var H=function(e){return Object(t.jsx)("div",{children:Object(t.jsxs)("div",{className:"space-x-3 flex justify-center align-center items-center playingCards faceImages simpleCards",children:[Object(t.jsx)(M,{onDrawStackClick:function(){e.onDrawStackClick()},drawStack:e.drawStack,paused:e.paused}),Object(t.jsx)(A,{onDiscardPileClick:function(){e.onDiscardPileClick()},discardPile:e.discardPile,paused:e.paused,lastPlayedCards:e.lastPlayedCards})]})})};n(14),n(15);var I=function(){var e=x(4),r=Object(a.useState)(e.players),n=Object(l.a)(r,2),c=n[0],s=n[1],i=Object(a.useState)([]),d=Object(l.a)(i,2),u=d[0],o=d[1],h=Object(a.useState)(e.deck),b=Object(l.a)(h,2),O=b[0],k=b[1],C=Object(a.useState)(m(0,e.players.length)),w=Object(l.a)(C,2),S=w[0],P=w[1],J=Object(a.useState)(""),A=Object(l.a)(J,2),M=A[0],I=A[1],K=Object(a.useState)([]),Q=Object(l.a)(K,2),R=Q[0],Y=Q[1],E=Object(a.useState)(!1),L=Object(l.a)(E,2),B=L[0],V=L[1],q=Object(a.useReducer)((function(e){return e+1}),0),z=Object(l.a)(q,2)[1],F=Object(a.useState)([]),G=Object(l.a)(F,2),T=G[0],U=G[1];function W(e,r){c[0].turn===S?0!==e.length?N(e)?(0===r?($(),Z(e,c[S])):(_(),Z(e,c[S])),Y([])):I("you can't play those cards"):I("you need to select cards to play"):I("not your turn")}function X(e,r){var n,t,a,i;if(e.length>1){var l=e;n=u.concat(l);for(var d=c.indexOf(r),h=c[d],b=0;b<l.length;b++)h.hand.splice(h.hand.indexOf(l[b]),1);h.points=g(h.hand),(t=c)[d]=h,a=[],i=T.concat(l)}else{(n=u).push(e);var f=c.indexOf(r),j=c[f];j.hand.splice(j.hand.indexOf(e),1),j.points=g(j.hand),(t=c)[f]=j,(a=R).includes(e)&&a.splice(a.indexOf(e),1),(i=T).push(e)}o(n),s(t),I(""),Y(a),U(i),z()}function Z(e,r){var n=e;if(n.length>1){var t={0:0,A:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:11,Q:12,K:13};n.sort((function(e,r){return t[v(e).number]-t[v(r).number]}))}var a=u;a=a.concat(n);for(var i=c.indexOf(r),l=c[i],d=0;d<e.length;d++)l.hand.includes(e[d])&&l.hand.splice(l.hand.indexOf(e[d]),1);l.points=g(l.hand);var h=c;h[i]=l,U(n),o(a),s(h),I(""),P(j(S,c.length))}function $(){var e=u;ee(e.pop(),c[S],1),o(e)}function _(){var e=O;ee(e.pop(),c[S],2),k(e)}function ee(e,r,n){var t=c.indexOf(r),a=c[t];a.hand.push(e),a.lastDrawPile=n;var i=c;i[t]=a,s(i)}function re(e){var r=e;if(r.turn===S){for(var n=c,t=!1,a=0;a<n.length;a++)if(n[a]!==r){var i=n[a];i.points>r.points?i.score+=i.points:i.points<=r.points&&!t&&(r.score+=35,t=!0),n[a]=i}for(var l=0;l<n.length;l++)100!==n[l].score&&200!==n[l].score||(n[l].score=n[l].score/2);s(n),V(!0)}else I("not your turn")}return Object(a.useEffect)((function(){var e=null;return B||0===S?clearInterval(e):e=setInterval((function(){(function(){if(0!==O.length){var e=c[S];if(e.points<=5)re(e);else{var r=e.hand,n=y(r,u,3);1===n.drawPile?$():_(),Z(n.cards,e)}}else I("draw stack is empty")})()}),1500),function(){return clearInterval(e)}})),Object(t.jsxs)("div",{className:"flex items-center justify-center flex-col bg-white",children:[Object(t.jsx)("div",{className:"border-b-2 py-8",children:Object(t.jsx)(f,{paused:B,turn:S,players:c})}),Object(t.jsx)("div",{className:"border-b-2 py-8",children:Object(t.jsx)(H,{discardPile:u,drawStack:O,onDiscardPileClick:function(){0!==u.length&&W(R,0)},onDrawStackClick:function(){return function(){if(0===O.length){var e=u,r=e.pop();return e=p(e),k(e),void o([r])}W(R,1)}()},paused:B,lastPlayedCards:T})}),Object(t.jsx)("div",{className:"py-8",children:Object(t.jsx)(D,{player:c[0],errorMessage:M,turn:S,onCardClick:function(e,r){return function(e,r){if(u.length>0){var n=u[u.length-1];if(v(n).number===v(r).number&&S===j(c[0].turn)&&r===c[0].hand[c[0].hand.length-1]&&2===c[0].lastDrawPile)return void X(r,c[0]);if(T.length>=3&&n+1===r&&"K"!==v(n).number)return void X(r,c[0]);if(T.length+e.length===4){for(var t=T.concat(e),a=!0,s=v(t[0]).number,i=1;i<t.length;i++)if(v(t[i]).number!==s){a=!1;break}if(a)return void X(e,c[0])}}Y(e)}(e,r)},onYanivClick:function(){re(c[0])},onReadyClick:function(){return function(){for(var e=!1,r=0;r<c.length;r++)if(c[r].score>200){e=!0;break}for(var n=c,t=x(4),a=0;a<t.players.length;a++)n[a].hand=t.players[a].hand,n[a].points=t.players[a].points,e?n[a].score=0:100!==n[a].score&&200!==n[a].score||(n[a].score=n[a].score/2);s(n),o([]),k(t.deck),P(j(S,c.length)),V(!1),Y([])}()},selectedCards:R,paused:B})})]})};var K=function(){return Object(t.jsx)("div",{className:"App",children:Object(t.jsx)(I,{})})};i.a.render(Object(t.jsx)(c.a.StrictMode,{children:Object(t.jsx)(K,{})}),document.getElementById("root"))}],[[16,1,2]]]);
//# sourceMappingURL=main.76ca8eb2.chunk.js.map