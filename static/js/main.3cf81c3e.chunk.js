(this.webpackJsonpyaniv=this.webpackJsonpyaniv||[]).push([[0],{15:function(e,t,a){},16:function(e,t,a){},17:function(e,t,a){},18:function(e,t,a){},19:function(e,t,a){"use strict";a.r(t);var r=a(0),s=a(1),n=a.n(s),i=a(9),c=a.n(i),l=(a(15),a(16),a(2)),d=a(3),u=a(5),o=a(4),h=a(7);var p=function(e){return Object(r.jsx)("li",{children:Object(r.jsx)("div",{className:"card back",children:"*"})})};var v=function(e){return Object(r.jsx)("div",{className:"text-green-600 font-bold",children:e.score})};var f=function(e){return Object(r.jsx)("div",{children:e.id})};var j=function(e){var t,a=[],s=Object(h.a)(e.player.hand);try{for(s.s();!(t=s.n()).done;){var n=t.value;a.push(Object(r.jsx)(p,{card:n},n))}}catch(i){s.e(i)}finally{s.f()}return Object(r.jsxs)("div",{className:"px-8",children:[Object(r.jsxs)("div",{className:"flex items-center justify-center p-3",children:[e.turn===e.player.turn?Object(r.jsx)("div",{className:"bg-yellow-300",children:Object(r.jsx)(f,{id:e.player.id})}):Object(r.jsx)("div",{className:"",children:Object(r.jsx)(f,{id:e.player.id})}),Object(r.jsx)("div",{className:"pl-2",children:Object(r.jsx)(v,{score:e.player.score})})]}),Object(r.jsx)("div",{className:"flex flex-wrap items-center playingCards faceImages simpleCards",children:Object(r.jsx)("ul",{className:"hand",children:a})}),e.paused&&Object(r.jsx)("div",{className:"text-red-500 pt-2 px-2 font-bold",children:e.player.points})]})};var b=function(e){for(var t=[],a=0;a<e.players.length;a++)0!==a&&t.push(Object(r.jsx)(j,{paused:e.paused,player:e.players[a],turn:e.turn},a));return Object(r.jsx)("div",{className:"flex flex-wrap content-center",children:t})},k=a(6),y=function(e){var t=Array.from(Array(13).keys()),a=Array.from({length:13},(function(e,t){return t+13})),r=Array.from({length:13},(function(e,t){return t+26})),s=Array.from({length:13},(function(e,t){return t+39})),n="",i=e;return t.includes(e)?n="H":a.includes(e)?(n="D",i-=13):r.includes(e)?(n="C",i-=26):s.includes(e)?(n="S",i-=39):[52,53].includes(e)&&(n="J",i="-1"),0===i?i="A":10===i?i="J":11===i?i="Q":12===i?i="K":-1===i?i=0:i++,{number:i,suit:n}},m=function(e){for(var t,a,r=e.length;0!==r;)a=Math.floor(Math.random()*r),t=e[r-=1],e[r]=e[a],e[a]=t;return e},x=function(e){var t=Array.from(Array(54).keys());t=m(t);for(var a=[],r=0;r<e;r++)a.push({id:"Player "+r,score:0,hand:n(5),turn:r,points:0});for(var s=0;s<a.length;s++)a[s].points=O(a[s].hand);function n(e){for(var a=[],r=0;r<e;r++)a.push(t.pop());return a}return{players:a,deck:t}},C=function(e,t){return Math.floor(Math.random()*t)+e},g={0:0,A:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:10,Q:10,K:10},O=function(e){for(var t=0,a=0;a<e.length;a++){var r=y(e[a]);t+=g[r.number]}return t},N=function(e,t,a){var r,s=function(e){for(var t=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0]],a={J:0,H:1,D:2,C:3,S:4},r={0:0,A:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:11,Q:12,K:13},s=0;s<e.length;s++){var n=y(e[s]),i=a[n.suit],c=r[n.number];t[i][c]++}return t}(e);switch(a){case 0:({cards:[e[C(0,e.length)]],drawPile:2});break;case 1:({cards:P(e,s),drawPile:2});break;case 2:var n=w(e);0===n.length&&(n=[e[C(0,e.length)]]),{cards:n,drawPile:2};break;default:({cards:[e[0]],drawPile:2})}var i=P(e,s),c=w(e),l=O(i),d=O(c);r=l>=d?i:c;var u=2;if(t.length>0){var o=t[t.length-1],h=y(o),p=g[h.number],v=e.filter((function(e){return r.indexOf(e)<0}));v=v.push(o),console.log(function(e){for(var t=[],a=0;a<e.length;a++)t.push(y(e[a]));return t}(v));var f=P(v,s),j=w(v);f.length>=2&&f.includes(o)?(console.log("set lengths match: "+f.length),u=1):j.length>=3&&f.includes(o)?(console.log("run lengths match: "+j.length),u=1):p<4&&(console.log("topCardValue match: "+p),u=1)}return{cards:r,drawPile:u}};function w(e){for(var t=[],a=[],r=[],s=[],n=[],i=0;i<e.length;i++){switch(y(e[i]).suit){case"H":t.push(e[i]);break;case"D":a.push(e[i]);break;case"C":r.push(e[i]);break;case"S":s.push(e[i]);break;case"J":n.push(e[i])}}var c=[t,a,r,s];c=c.sort((function(e,t){return t.length-e.length}));for(var l=[],d=0;d<c.length;d++){var u=c[d].concat(n);if(S(c[d])){l=c[d];break}if(1===n.length&&S(u)){l=u;break}if(2===n.length&&S(c[d].concat(n[0]))){l=c[d].concat(n[0]);break}if(2===n.length&&S(u)){l=u;break}}if(l.length<=1){var o=y(e[0]),h=g[o.number];l=[e[0]];for(var p=1;p<e.length;p++){var v=y(e[p]),f=g[v.number];f>h&&(h=f,l=[e[p]])}}return l}function P(e,t){for(var a=t.reduce((function(e,t){return e.map((function(e,a){return t[a]+e}))})),r=Math.max.apply(Math,a),s=0,n=0;n<a.length;n++)a[n]===r&&(s=n);for(var i=[],c={0:0,A:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:11,Q:12,K:13},l=0;l<e.length;l++)c[y(e[l]).number]===s&&i.push(e[l]);return i}var S=function(e){for(var t={0:0,A:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:11,Q:12,K:13},a=[],r=0;r<e.length;r++){var s=y(e[r]);s.number=t[s.number],a.push(s)}var n=!1,i=!1;a.length>=2&&(n=function(e){for(var t=!0,a=e[0].number,r=0;r<e.length;r++)if(0!==e[r].number&&e[r].number!==a){t=!1;break}return t}(a)),a.length>=3&&(i=function(e){for(var t=!0,a="",r=0;r<e.length;r++)if("J"!==e[r].suit){a=e[r].suit;break}for(var s=[],n=0,i=0;i<e.length;i++)if("J"===e[i].suit)n++;else{if(e[i].suit!==a&&"J"!==e[i].suit){t=!1;break}s.push(e[i].number)}s=s.sort((function(e,t){return e-t}));for(var c=1;c<s.length;c++){var l=s[c]-s[c-1];if(l>=4||3===l&&n<2||2===l&&n<1){t=!1;break}}return t}(a));var c=!1;return(1===e.length||n||i)&&(c=!0),c};var D=function(e){Object(u.a)(a,e);var t=Object(o.a)(a);function a(e){var r;return Object(l.a)(this,a),(r=t.call(this,e)).state={selected:!1},r}return Object(d.a)(a,[{key:"handleCardClick",value:function(e){if(!this.props.paused){var t=!this.state.selected;this.setState({selected:t}),this.props.onCardClick(e)}}},{key:"render",value:function(){var e,t,a=this,s=y(this.props.card),n=this.state.selected,i={H:"hearts",D:"diams",C:"clubs",S:"spades",J:"joker"}[s.suit],c="selectable cursor-pointer card rank-"+s.number+" "+i;switch(52===this.props.card?c+=" little":53===this.props.card&&(c+=" big"),c=c.toLowerCase(),s.suit){case"H":e=Object(r.jsx)("div",{className:"suit",children:"\u2665"});break;case"D":e=Object(r.jsx)("div",{className:"suit",children:"\u2666"});break;case"C":e=Object(r.jsx)("div",{className:"suit",children:"\u2663"});break;case"S":e=Object(r.jsx)("div",{className:"suit",children:"\u2660"});break;case"J":e=Object(r.jsx)("div",{className:"suit",children:"Joker"})}return t=n?Object(r.jsx)("strong",{children:Object(r.jsxs)("label",{onClick:function(){return a.handleCardClick()},className:c,children:[Object(r.jsx)("div",{className:"rank",children:s.number}),e]})}):Object(r.jsxs)("div",{onClick:function(){return a.handleCardClick()},className:c,children:[Object(r.jsx)("div",{className:"rank",children:s.number}),e]}),Object(r.jsx)("div",{className:"playingCards faceImages simpleCards",children:t})}}]),a}(n.a.Component);var J=function(e){var t,a=[],s=Object(h.a)(e.player.hand);try{var n=function(){var s=t.value;a.push(Object(r.jsx)(D,{paused:e.paused,card:s,onCardClick:function(){return function(t){e.onCardClick(t)}(s)}},s))};for(s.s();!(t=s.n()).done;)n()}catch(i){s.e(i)}finally{s.f()}return Object(r.jsx)("div",{className:"flex flex-wrap items-center justify-center",children:a})};var M=function(){return Object(r.jsx)("div",{children:Object(r.jsx)("button",{className:"px-4 py-1 rounded-md text-white bg-purple-500 hover:bg-purple-600 focus:outline-none",children:"Yaniv"})})};var A=function(){return Object(r.jsx)("div",{children:Object(r.jsx)("button",{className:"px-4 py-1 rounded-md text-white bg-blue-500 hover:bg-blue-600 focus:outline-none",children:"Ready"})})},I=function(e){Object(u.a)(a,e);var t=Object(o.a)(a);function a(e){var r;return Object(l.a)(this,a),(r=t.call(this,e)).handleCardClick=r.handleCardClick.bind(Object(k.a)(r)),r}return Object(d.a)(a,[{key:"handleCardClick",value:function(e){var t=this.props.selectedCards;t.includes(e)?t.splice(t.indexOf(e),1):t.push(e),this.props.onCardClick(t)}},{key:"handleYanivClick",value:function(){this.props.onYanivClick()}},{key:"handleReadyClick",value:function(){this.props.onReadyClick()}},{key:"render",value:function(){var e=this,t=O(this.props.player.hand);return Object(r.jsxs)("div",{className:"flex flex-col",children:[Object(r.jsx)("div",{className:"flex items-center justify-center",children:Object(r.jsx)(J,{selectedCards:this.props.selectedCards,paused:this.props.paused,player:this.props.player,onCardClick:this.handleCardClick})}),Object(r.jsxs)("div",{className:"flex items-center justify-center pt-6",children:[Object(r.jsx)("span",{className:"text-red-500 pr-2 font-bold",children:this.props.player.points}),Object(r.jsx)("span",{className:"pr-2",children:Object(r.jsx)(v,{score:this.props.player.score})}),this.props.turn===this.props.player.turn?Object(r.jsx)("div",{className:"bg-yellow-300",children:Object(r.jsx)(f,{id:this.props.player.id})}):Object(r.jsx)("div",{className:"",children:Object(r.jsx)(f,{id:this.props.player.id})}),t<=5&&!this.props.paused&&Object(r.jsx)("div",{onClick:function(){return e.handleYanivClick()},className:"pl-4",children:Object(r.jsx)(M,{})}),this.props.paused&&Object(r.jsx)("div",{onClick:function(){return e.handleReadyClick()},className:"pl-4",children:Object(r.jsx)(A,{})})]}),Object(r.jsx)("div",{className:"pt-6 text-red-500",children:this.props.errorMessage})]})}}]),a}(n.a.Component);var H=function(e){var t,a,s,n,i;if(e.discardPile.length>0){switch(a={H:"hearts",D:"diams",C:"clubs",S:"spades",J:"joker"}[(t=y(e.discardPile[e.discardPile.length-1])).suit],s="selectable cursor-pointer card rank-"+t.number+" "+a,52===e.discardPile[e.discardPile.length-1]?s+=" little":53===e.discardPile[e.discardPile.length-1]&&(s+=" big"),s=s.toLowerCase(),t.suit){case"H":n=Object(r.jsx)("div",{className:"suit",children:"\u2665"});break;case"D":n=Object(r.jsx)("div",{className:"suit",children:"\u2666"});break;case"C":n=Object(r.jsx)("div",{className:"suit",children:"\u2663"});break;case"S":n=Object(r.jsx)("div",{className:"suit",children:"\u2660"});break;case"J":n=Object(r.jsx)("div",{className:"suit",children:"Joker"})}i=Object(r.jsxs)("div",{onClick:function(){e.paused||void 0===e.discardPile||0===e.discardPile.length||e.onDiscardPileClick()},className:s,children:[Object(r.jsx)("div",{className:"rank",children:t.number}),n]})}else i=Object(r.jsx)("div",{className:"flex items-center justify-center text-sm w-16 h-20 mx-3 rounded-md bg-white border-4 border-gray-200 focus:outline-none",children:"discard pile"});return Object(r.jsx)("div",{className:"playingCards faceImages simpleCards",children:i})};var Y=function(e){function t(){e.onDrawStackClick()}var a;return a=e.drawStack.length>0?Object(r.jsx)("div",{onClick:t,className:"selectable cursor-pointer card back",children:"*"}):Object(r.jsx)("div",{onClick:t,className:"selectable cursor-pointer text-md flex items-center justify-center w-16 h-20 mx-3 rounded-md bg-white border-4 border-gray-200 hover:border-gray-300 focus:outline-none",children:"shuffle"}),Object(r.jsx)("div",{className:"playingCards faceImages simpleCards",children:a})};var T=function(e){return Object(r.jsx)("div",{children:Object(r.jsxs)("div",{className:"flex justify-center align-center items-center",children:[Object(r.jsx)(H,{onDiscardPileClick:function(){e.onDiscardPileClick()},discardPile:e.discardPile,paused:e.paused}),Object(r.jsx)(Y,{onDrawStackClick:function(){e.onDrawStackClick()},drawStack:e.drawStack,paused:e.paused})]})})},R=(a(17),a(18),function(e){Object(u.a)(a,e);var t=Object(o.a)(a);function a(e){var r;Object(l.a)(this,a),r=t.call(this,e);var s=x(4);return r.state={players:s.players,discardPile:[],drawStack:s.deck,turn:C(0,s.players.length),errorMessage:"",selectedCards:[],paused:!1},r}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.startInterval()}},{key:"componentWillUnmount",value:function(){this.clearInterval()}},{key:"startInterval",value:function(){var e=this;this.clearInterval(),this.interval=setInterval((function(){return e.handleTimeout()}),1e3)}},{key:"clearInterval",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){clearInterval(this.interval)}))},{key:"handleTimeout",value:function(){0!==this.state.turn?this.handleAutoPlayClick():this.clearInterval()}},{key:"handleDiscardPileClick",value:function(){0!==this.state.discardPile.length&&this.handlePlayClick(this.state.selectedCards,0)}},{key:"handleDrawStackClick",value:function(){if(0===this.state.drawStack.length){var e=this.state.discardPile,t=e.pop();return e=m(e),void this.setState({drawStack:e,discardPile:[t]})}this.handlePlayClick(this.state.selectedCards,1)}},{key:"handlePlayClick",value:function(e,t){this.state.players[0].turn===this.state.turn?0!==e.length?S(e)?(0===t?(this.drawFromDiscardPile(),this.playCards(e,this.state.players[this.state.turn])):(this.drawFromDrawStack(),this.playCards(e,this.state.players[this.state.turn])),this.setState({selectedCards:[]}),this.startInterval()):this.setState({errorMessage:"you can't play those cards"}):this.setState({errorMessage:"you need to select cards to play"}):this.setState({errorMessage:"not your turn"})}},{key:"handleCardClick",value:function(e){console.log("selectedCards: "+e),this.setState({selectedCards:e})}},{key:"playCards",value:function(e,t){var a=this.state.discardPile;a=a.concat(e);for(var r=this.state.players.indexOf(t),s=this.state.players[r],n=0;n<e.length;n++)s.hand.includes(e[n])&&s.hand.splice(s.hand.indexOf(e[n]),1);s.points=O(s.hand);var i=this.state.players;i[r]=s,this.setState({discardPile:a,players:i,errorMessage:"",turn:this.getNextTurn()})}},{key:"drawFromDiscardPile",value:function(){var e=this.state.discardPile,t=e.pop();this.addCardToPlayerHand(t,this.state.players[this.state.turn]),this.setState({discardPile:e})}},{key:"drawFromDrawStack",value:function(){var e=this.state.drawStack,t=e.pop();this.addCardToPlayerHand(t,this.state.players[this.state.turn]),this.setState({drawStack:e})}},{key:"addCardToPlayerHand",value:function(e,t){var a=this.state.players.indexOf(t),r=this.state.players[a];r.hand.push(e);var s=this.state.players;s[a]=r,this.setState({players:s})}},{key:"handleAutoPlayClick",value:function(){if(0!==this.state.drawStack.length){var e=this.state.players[this.state.turn];if(e.points<=5)return this.clearInterval(),void this.callYaniv(e);var t=e.hand,a=N(t,this.state.discardPile,3);1===a.drawPile?this.drawFromDiscardPile():this.drawFromDrawStack(),this.playCards(a.cards,e)}else this.setState({errorMessage:"draw stack is empty"})}},{key:"handleYanivClick",value:function(){this.callYaniv(this.state.players[0])}},{key:"callYaniv",value:function(e){var t=e;if(t.turn===this.state.turn){for(var a=this.state.players,r=!1,s=0;s<a.length;s++)if(a[s]!==t){var n=a[s];n.points>t.points?n.score+=n.points:n.points<=t.points&&!r&&(t.score+=35,r=!0),a[s]=n}this.setState({players:a,paused:!0})}else this.setState({errorMessage:"not your turn"})}},{key:"handleReadyClick",value:function(){for(var e=this.state.players,t=x(4),a=0;a<t.players.length;a++)e[a].hand=t.players[a].hand,e[a].points=t.players[a].points;this.setState({players:e,discardPile:[],drawStack:t.deck,turn:this.getNextTurn(),paused:!1,selectedCards:[]}),this.startInterval()}},{key:"getNextTurn",value:function(){var e=this.state.turn;return e+1>=this.state.players.length?e=0:e+=1,e}},{key:"render",value:function(){var e=this;return Object(r.jsxs)("div",{className:"flex items-center justify-center flex-col bg-white",children:[Object(r.jsx)("div",{className:"border-b-2 p-8",children:Object(r.jsx)(b,{paused:this.state.paused,turn:this.state.turn,players:this.state.players})}),Object(r.jsx)("div",{className:"border-b-2 p-8",children:Object(r.jsx)(T,{discardPile:this.state.discardPile,drawStack:this.state.drawStack,onDiscardPileClick:function(){return e.handleDiscardPileClick()},onDrawStackClick:function(){return e.handleDrawStackClick()},paused:this.state.paused})}),Object(r.jsx)("div",{className:"p-8",children:Object(r.jsx)(I,{onAutoPlayClick:function(){return e.handleAutoPlayClick()},player:this.state.players[0],errorMessage:this.state.errorMessage,turn:this.state.turn,onCardClick:function(t){return e.handleCardClick(t)},onYanivClick:function(){return e.handleYanivClick()},onReadyClick:function(){return e.handleReadyClick()},selectedCards:this.state.selectedCards,paused:this.state.paused})})]})}}]),a}(n.a.Component));var F=function(){return Object(r.jsx)("div",{className:"App",children:Object(r.jsx)(R,{})})};c.a.render(Object(r.jsx)(n.a.StrictMode,{children:Object(r.jsx)(F,{})}),document.getElementById("root"))}},[[19,1,2]]]);
//# sourceMappingURL=main.3cf81c3e.chunk.js.map