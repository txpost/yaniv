(this.webpackJsonpyaniv=this.webpackJsonpyaniv||[]).push([[0],{15:function(e,t,a){},16:function(e,t,a){},17:function(e,t,a){},18:function(e,t,a){},19:function(e,t,a){"use strict";a.r(t);var s=a(0),r=a(1),n=a.n(r),i=a(9),c=a.n(i),l=(a(15),a(16),a(2)),d=a(3),u=a(5),h=a(4),o=a(7);var p=function(e){return Object(s.jsx)("li",{children:Object(s.jsx)("div",{className:"card back",children:"*"})})};var v=function(e){return Object(s.jsx)("div",{className:"text-green-600 font-bold",children:e.score})};var f=function(e){return Object(s.jsx)("div",{children:e.id})};var j=function(e){var t,a=[],r=Object(o.a)(e.player.hand);try{for(r.s();!(t=r.n()).done;){var n=t.value;a.push(Object(s.jsx)(p,{card:n},n))}}catch(i){r.e(i)}finally{r.f()}return Object(s.jsxs)("div",{className:"px-8",children:[Object(s.jsxs)("div",{className:"flex items-center justify-center p-3",children:[e.turn===e.player.turn?Object(s.jsx)("div",{className:"bg-yellow-300",children:Object(s.jsx)(f,{id:e.player.id})}):Object(s.jsx)("div",{className:"",children:Object(s.jsx)(f,{id:e.player.id})}),Object(s.jsx)("div",{className:"pl-2",children:Object(s.jsx)(v,{score:e.player.score})}),e.paused&&Object(s.jsx)("span",{className:"text-red-500 pl-2 font-bold",children:e.player.points})]}),Object(s.jsx)("div",{className:"flex flex-wrap items-center playingCards faceImages simpleCards",children:Object(s.jsx)("ul",{className:"hand",children:a})})]})};var b=function(e){for(var t=[],a=0;a<e.players.length;a++)0!==a&&t.push(Object(s.jsx)(j,{paused:e.paused,player:e.players[a],turn:e.turn},a));return Object(s.jsx)("div",{className:"flex flex-wrap content-center",children:t})},y=a(6),k=function(e){var t=Array.from(Array(13).keys()),a=Array.from({length:13},(function(e,t){return t+13})),s=Array.from({length:13},(function(e,t){return t+26})),r=Array.from({length:13},(function(e,t){return t+39})),n="",i=e;return t.includes(e)?n="H":a.includes(e)?(n="D",i-=13):s.includes(e)?(n="C",i-=26):r.includes(e)?(n="S",i-=39):[52,53].includes(e)&&(n="J",i="-1"),0===i?i="A":10===i?i="J":11===i?i="Q":12===i?i="K":-1===i?i=0:i++,{number:i,suit:n}},m=function(e){for(var t,a,s=e.length;0!==s;)a=Math.floor(Math.random()*s),t=e[s-=1],e[s]=e[a],e[a]=t;return e},x=function(e){var t=Array.from(Array(54).keys());t=m(t);for(var a=[],s=0;s<e;s++)a.push({id:"Player "+s,score:0,hand:n(5),turn:s,points:0});for(var r=0;r<a.length;r++)a[r].points=O(a[r].hand);function n(e){for(var a=[],s=0;s<e;s++)a.push(t.pop());return a}return{players:a,deck:t}},C=function(e,t){return Math.floor(Math.random()*t)+e},g={0:0,A:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:10,Q:10,K:10},O=function(e){for(var t=0,a=0;a<e.length;a++){var s=k(e[a]);t+=g[s.number]}return t},w=function(e,t,a){var s,r=function(e){for(var t=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0]],a={J:0,H:1,D:2,C:3,S:4},s={0:0,A:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:11,Q:12,K:13},r=0;r<e.length;r++){var n=k(e[r]),i=a[n.suit],c=s[n.number];t[i][c]++}return t}(e);switch(a){case 0:({cards:[e[C(0,e.length)]],drawPile:2});break;case 1:({cards:P(e,r),drawPile:2});break;case 2:var n=N(e);0===n.length&&(n=[e[C(0,e.length)]]),{cards:n,drawPile:2};break;default:({cards:[e[0]],drawPile:2})}var i=P(e,r),c=N(e),l=O(i),d=O(c);s=l>=d?i:c;var u=2;if(t.length>0){var h=t[t.length-1],o=k(h),p=g[o.number],v=e.filter((function(e){return s.indexOf(e)<0})),f=P(v=v.push(h),r),j=N(v);f.length>=2&&f.includes(h)?(console.log("set lengths match: "+f.length),u=1):j.length>=3&&f.includes(h)?(console.log("run lengths match: "+j.length),u=1):p<4&&(console.log("topCardValue match: "+p),u=1)}return{cards:s,drawPile:u}};function N(e){for(var t=[],a=[],s=[],r=[],n=[],i=0;i<e.length;i++){switch(k(e[i]).suit){case"H":t.push(e[i]);break;case"D":a.push(e[i]);break;case"C":s.push(e[i]);break;case"S":r.push(e[i]);break;case"J":n.push(e[i])}}var c=[t,a,s,r];c=c.sort((function(e,t){return t.length-e.length}));for(var l=[],d=0;d<c.length;d++){var u=c[d].concat(n);if(S(c[d])){l=c[d];break}if(1===n.length&&S(u)){l=u;break}if(2===n.length&&S(c[d].concat(n[0]))){l=c[d].concat(n[0]);break}if(2===n.length&&S(u)){l=u;break}}if(l.length<=1){var h=k(e[0]),o=g[h.number];l=[e[0]];for(var p=1;p<e.length;p++){var v=k(e[p]),f=g[v.number];f>o&&(o=f,l=[e[p]])}}return l}function P(e,t){for(var a=t.reduce((function(e,t){return e.map((function(e,a){return t[a]+e}))})),s=Math.max.apply(Math,a),r=0,n=0;n<a.length;n++)a[n]===s&&(r=n);for(var i=[],c={0:0,A:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:11,Q:12,K:13},l=0;l<e.length;l++)c[k(e[l]).number]===r&&i.push(e[l]);return i}var S=function(e){for(var t={0:0,A:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:11,Q:12,K:13},a=[],s=0;s<e.length;s++){var r=k(e[s]);r.number=t[r.number],a.push(r)}var n=!1,i=!1;a.length>=2&&(n=function(e){for(var t=!0,a=e[0].number,s=0;s<e.length;s++)if(0!==e[s].number&&e[s].number!==a){t=!1;break}return t}(a)),a.length>=3&&(i=function(e){for(var t=!0,a="",s=0;s<e.length;s++)if("J"!==e[s].suit){a=e[s].suit;break}for(var r=[],n=0,i=0;i<e.length;i++)if("J"===e[i].suit)n++;else{if(e[i].suit!==a&&"J"!==e[i].suit){t=!1;break}r.push(e[i].number)}r=r.sort((function(e,t){return e-t}));for(var c=1;c<r.length;c++){var l=r[c]-r[c-1];if(l>=4||3===l&&n<2||2===l&&n<1){t=!1;break}}return t}(a));var c=!1;return(1===e.length||n||i)&&(c=!0),c};var D=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(e){var s;return Object(l.a)(this,a),(s=t.call(this,e)).state={selected:!1},s}return Object(d.a)(a,[{key:"handleCardClick",value:function(){if(!this.props.paused){var e=!this.state.selected;this.setState({selected:e}),this.props.onCardClick(this.props.card)}}},{key:"render",value:function(){var e,t,a=this,r=k(this.props.card),n=this.state.selected,i={H:"hearts",D:"diams",C:"clubs",S:"spades",J:"joker"}[r.suit],c="selectable cursor-pointer card rank-"+r.number+" "+i;switch(52===this.props.card?c+=" little":53===this.props.card&&(c+=" big"),c=c.toLowerCase(),r.suit){case"H":e=Object(s.jsx)("div",{className:"suit",children:"\u2665"});break;case"D":e=Object(s.jsx)("div",{className:"suit",children:"\u2666"});break;case"C":e=Object(s.jsx)("div",{className:"suit",children:"\u2663"});break;case"S":e=Object(s.jsx)("div",{className:"suit",children:"\u2660"});break;case"J":e=Object(s.jsx)("div",{className:"suit",children:"Joker"})}return t=n?Object(s.jsx)("strong",{children:Object(s.jsxs)("label",{onClick:function(){return a.handleCardClick()},className:c,children:[Object(s.jsx)("div",{className:"rank",children:r.number}),e]})}):Object(s.jsxs)("div",{onClick:function(){return a.handleCardClick()},className:c,children:[Object(s.jsx)("div",{className:"rank",children:r.number}),e]}),Object(s.jsx)("div",{className:"playingCards faceImages simpleCards",children:t})}}]),a}(n.a.Component);var M=function(e){var t=[];function a(t){e.onCardClick(t)}var r,n=Object(o.a)(e.player.hand);try{for(n.s();!(r=n.n()).done;){var i=r.value;t.push(Object(s.jsx)(D,{paused:e.paused,card:i,onCardClick:function(e){return a(e)}},i))}}catch(c){n.e(c)}finally{n.f()}return Object(s.jsx)("div",{className:"flex flex-wrap items-center justify-center",children:t})};var J=function(){return Object(s.jsx)("div",{children:Object(s.jsx)("button",{className:"px-4 py-1 rounded-md text-white bg-purple-500 hover:bg-purple-600 focus:outline-none",children:"Yaniv"})})};var A=function(){return Object(s.jsx)("div",{children:Object(s.jsx)("button",{className:"px-4 py-1 rounded-md text-white bg-blue-500 hover:bg-blue-600 focus:outline-none",children:"Ready"})})},I=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(e){var s;return Object(l.a)(this,a),(s=t.call(this,e)).handleCardClick=s.handleCardClick.bind(Object(y.a)(s)),s}return Object(d.a)(a,[{key:"handleCardClick",value:function(e){var t=this.props.selectedCards;t.includes(e)?t.splice(t.indexOf(e),1):t.push(e),this.props.onCardClick(t,e)}},{key:"handleYanivClick",value:function(){this.props.onYanivClick()}},{key:"handleReadyClick",value:function(){this.props.onReadyClick()}},{key:"render",value:function(){var e=this,t=O(this.props.player.hand);return Object(s.jsxs)("div",{className:"flex flex-col",children:[Object(s.jsx)("div",{className:"flex items-center justify-center",children:Object(s.jsx)(M,{selectedCards:this.props.selectedCards,paused:this.props.paused,player:this.props.player,onCardClick:function(t){return e.handleCardClick(t)}})}),Object(s.jsxs)("div",{className:"flex items-center justify-center pt-6",children:[this.props.turn===this.props.player.turn?Object(s.jsx)("div",{className:"bg-yellow-300",children:Object(s.jsx)(f,{id:this.props.player.id})}):Object(s.jsx)("div",{className:"",children:Object(s.jsx)(f,{id:this.props.player.id})}),Object(s.jsx)("span",{className:"pl-2",children:Object(s.jsx)(v,{score:this.props.player.score})}),this.props.paused&&Object(s.jsx)("span",{className:"text-red-500 font-bold pl-2",children:this.props.player.points}),t<=5&&!this.props.paused&&Object(s.jsx)("div",{onClick:function(){return e.handleYanivClick()},className:"pl-4",children:Object(s.jsx)(J,{})}),this.props.paused&&Object(s.jsx)("div",{onClick:function(){return e.handleReadyClick()},className:"pl-4",children:Object(s.jsx)(A,{})})]}),Object(s.jsx)("div",{className:"pt-6 text-red-500",children:this.props.errorMessage})]})}}]),a}(n.a.Component);var H=function(e){var t,a,r,n,i;if(e.discardPile.length>0){switch(a={H:"hearts",D:"diams",C:"clubs",S:"spades",J:"joker"}[(t=k(e.discardPile[e.discardPile.length-1])).suit],r="selectable cursor-pointer card rank-"+t.number+" "+a,52===e.discardPile[e.discardPile.length-1]?r+=" little":53===e.discardPile[e.discardPile.length-1]&&(r+=" big"),r=r.toLowerCase(),t.suit){case"H":n=Object(s.jsx)("div",{className:"suit",children:"\u2665"});break;case"D":n=Object(s.jsx)("div",{className:"suit",children:"\u2666"});break;case"C":n=Object(s.jsx)("div",{className:"suit",children:"\u2663"});break;case"S":n=Object(s.jsx)("div",{className:"suit",children:"\u2660"});break;case"J":n=Object(s.jsx)("div",{className:"suit",children:"Joker"})}i=Object(s.jsxs)("div",{onClick:function(){e.paused||void 0===e.discardPile||0===e.discardPile.length||e.onDiscardPileClick()},className:r,children:[Object(s.jsx)("div",{className:"rank",children:t.number}),n]})}else i=Object(s.jsx)("div",{className:"flex items-center justify-center text-sm w-16 h-20 mx-3 rounded-md bg-white border-4 border-gray-200 focus:outline-none",children:"discard pile"});return Object(s.jsx)("div",{className:"playingCards faceImages simpleCards",children:i})};var Y=function(e){function t(){e.onDrawStackClick()}var a;return a=e.drawStack.length>0?Object(s.jsx)("div",{onClick:t,className:"selectable cursor-pointer card back",children:"*"}):Object(s.jsx)("div",{onClick:t,className:"selectable cursor-pointer text-md flex items-center justify-center w-16 h-20 mx-3 rounded-md bg-white border-4 border-gray-200 hover:border-gray-300 focus:outline-none",children:"shuffle"}),Object(s.jsx)("div",{className:"playingCards faceImages simpleCards",children:a})};var T=function(e){return Object(s.jsx)("div",{children:Object(s.jsxs)("div",{className:"flex justify-center align-center items-center",children:[Object(s.jsx)(H,{onDiscardPileClick:function(){e.onDiscardPileClick()},discardPile:e.discardPile,paused:e.paused}),Object(s.jsx)(Y,{onDrawStackClick:function(){e.onDrawStackClick()},drawStack:e.drawStack,paused:e.paused})]})})},R=(a(17),a(18),function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(e){var s;Object(l.a)(this,a),s=t.call(this,e);var r=x(4);return s.state={players:r.players,discardPile:[],drawStack:r.deck,turn:C(0,r.players.length),errorMessage:"",selectedCards:[],paused:!1},s}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.startInterval()}},{key:"componentWillUnmount",value:function(){this.clearInterval()}},{key:"startInterval",value:function(){var e=this;this.clearInterval(),this.interval=setInterval((function(){return e.handleTimeout()}),1e3)}},{key:"clearInterval",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){clearInterval(this.interval)}))},{key:"handleTimeout",value:function(){0!==this.state.turn?this.handleAutoPlayClick():this.clearInterval()}},{key:"handleDiscardPileClick",value:function(){0!==this.state.discardPile.length&&this.handlePlayClick(this.state.selectedCards,0)}},{key:"handleDrawStackClick",value:function(){if(0===this.state.drawStack.length){var e=this.state.discardPile,t=e.pop();return e=m(e),void this.setState({drawStack:e,discardPile:[t]})}this.handlePlayClick(this.state.selectedCards,1)}},{key:"handlePlayClick",value:function(e,t){this.state.players[0].turn===this.state.turn?0!==e.length?S(e)?(0===t?(this.drawFromDiscardPile(),this.playCards(e,this.state.players[this.state.turn])):(this.drawFromDrawStack(),this.playCards(e,this.state.players[this.state.turn])),this.setState({selectedCards:[]}),this.startInterval()):this.setState({errorMessage:"you can't play those cards"}):this.setState({errorMessage:"you need to select cards to play"}):this.setState({errorMessage:"not your turn"})}},{key:"handleCardClick",value:function(e,t){if(this.state.discardPile.length>0){var a=this.state.discardPile[this.state.discardPile.length-1];if(k(a).number===k(t).number&&this.state.turn!==this.state.players[0].turn)return this.slapDownCard(t,this.state.players[0]),void console.log("slap down")}this.setState({selectedCards:e})}},{key:"slapDownCard",value:function(e,t){var a=this.state.discardPile;a.push(e);var s=this.state.players.indexOf(t),r=this.state.players[s];r.hand.splice(r.hand.indexOf(e),1),r.points=O(r.hand);var n=this.state.players;n[s]=r;var i=this.state.selectedCards;i.includes(e)&&i.splice(i.indexOf(e),1),this.setState({discardPile:a,players:n,errorMessage:"",selectedCards:i})}},{key:"playCards",value:function(e,t){var a=e;if(e.length>1)for(var s=Math.max.apply(Math,e.map((function(e){return O([e])}))),r=0;r<a.length;r++)if(O([a[r]])===s){a.push(a.splice(r,1)[0]);break}var n=this.state.discardPile;n=n.concat(a);for(var i=this.state.players.indexOf(t),c=this.state.players[i],l=0;l<e.length;l++)c.hand.includes(e[l])&&c.hand.splice(c.hand.indexOf(e[l]),1);c.points=O(c.hand);var d=this.state.players;d[i]=c,this.setState({discardPile:n,players:d,errorMessage:"",turn:this.getNextTurn()})}},{key:"drawFromDiscardPile",value:function(){var e=this.state.discardPile,t=e.pop();this.addCardToPlayerHand(t,this.state.players[this.state.turn]),this.setState({discardPile:e})}},{key:"drawFromDrawStack",value:function(){var e=this.state.drawStack,t=e.pop();this.addCardToPlayerHand(t,this.state.players[this.state.turn]),this.setState({drawStack:e})}},{key:"addCardToPlayerHand",value:function(e,t){var a=this.state.players.indexOf(t),s=this.state.players[a];s.hand.push(e);var r=this.state.players;r[a]=s,this.setState({players:r})}},{key:"handleAutoPlayClick",value:function(){if(0!==this.state.drawStack.length){var e=this.state.players[this.state.turn];if(e.points<=5)return this.clearInterval(),void this.callYaniv(e);var t=e.hand,a=w(t,this.state.discardPile,3);1===a.drawPile?this.drawFromDiscardPile():this.drawFromDrawStack(),this.playCards(a.cards,e)}else this.setState({errorMessage:"draw stack is empty"})}},{key:"handleYanivClick",value:function(){this.callYaniv(this.state.players[0])}},{key:"callYaniv",value:function(e){var t=e;if(t.turn===this.state.turn){for(var a=this.state.players,s=!1,r=0;r<a.length;r++)if(a[r]!==t){var n=a[r];n.points>t.points?n.score+=n.points:n.points<=t.points&&!s&&(t.score+=35,s=!0),a[r]=n}for(var i=0;i<a.length;i++)100!==a[i].score&&200!==a[i].score||(a[i].score=a[i].score/2);this.setState({players:a,paused:!0})}else this.setState({errorMessage:"not your turn"})}},{key:"handleReadyClick",value:function(){for(var e=!1,t=0;t<this.state.players.length;t++){if(this.state.players[t].score>200){e=!0;break}}for(var a=this.state.players,s=x(4),r=0;r<s.players.length;r++)a[r].hand=s.players[r].hand,a[r].points=s.players[r].points,e?a[r].score=0:100!==a[r].score&&200!==a[r].score||(a[r].score=a[r].score/2);this.setState({players:a,discardPile:[],drawStack:s.deck,turn:this.getNextTurn(),paused:!1,selectedCards:[]}),this.startInterval()}},{key:"getNextTurn",value:function(){var e=this.state.turn;return e+1>=this.state.players.length?e=0:e+=1,e}},{key:"render",value:function(){var e=this;return Object(s.jsxs)("div",{className:"flex items-center justify-center flex-col bg-white",children:[Object(s.jsx)("div",{className:"border-b-2 p-8",children:Object(s.jsx)(b,{paused:this.state.paused,turn:this.state.turn,players:this.state.players})}),Object(s.jsx)("div",{className:"border-b-2 p-8",children:Object(s.jsx)(T,{discardPile:this.state.discardPile,drawStack:this.state.drawStack,onDiscardPileClick:function(){return e.handleDiscardPileClick()},onDrawStackClick:function(){return e.handleDrawStackClick()},paused:this.state.paused})}),Object(s.jsx)("div",{className:"p-8",children:Object(s.jsx)(I,{onAutoPlayClick:function(){return e.handleAutoPlayClick()},player:this.state.players[0],errorMessage:this.state.errorMessage,turn:this.state.turn,onCardClick:function(t,a){return e.handleCardClick(t,a)},onYanivClick:function(){return e.handleYanivClick()},onReadyClick:function(){return e.handleReadyClick()},selectedCards:this.state.selectedCards,paused:this.state.paused})})]})}}]),a}(n.a.Component));var F=function(){return Object(s.jsx)("div",{className:"App",children:Object(s.jsx)(R,{})})};c.a.render(Object(s.jsx)(n.a.StrictMode,{children:Object(s.jsx)(F,{})}),document.getElementById("root"))}},[[19,1,2]]]);
//# sourceMappingURL=main.592f7d16.chunk.js.map