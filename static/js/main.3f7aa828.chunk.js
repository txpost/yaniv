(this.webpackJsonpyaniv=this.webpackJsonpyaniv||[]).push([[0],{29:function(e,r,t){},30:function(e,r,t){},31:function(e,r,t){},32:function(e,r,t){},38:function(e,r,t){"use strict";t.r(r);var n=t(2),a=t(4),c=t.n(a),s=t(20),i=t.n(s),l=(t(29),t(30),t(8)),d=t(12);var u=function(e){return Object(n.jsx)("div",{className:"card back",children:"*"})};var o=function(e){return Object(n.jsx)("div",{className:"text-green-600 font-bold",children:e.score})};var b=function(e){return Object(n.jsx)("div",{children:e.id})};var j=function(e){var r,t=[],a=Object(d.a)(e.player.hand);try{for(a.s();!(r=a.n()).done;){var c=r.value;t.push(Object(n.jsx)(u,{card:c},c))}}catch(s){a.e(s)}finally{a.f()}return Object(n.jsxs)("div",{className:"px-8",children:[Object(n.jsxs)("div",{className:"flex items-center justify-center py-3",children:[e.turn===e.player.turn?Object(n.jsx)("div",{className:"bg-yellow-300",children:Object(n.jsx)(b,{id:e.player.id})}):Object(n.jsx)("div",{className:"",children:Object(n.jsx)(b,{id:e.player.id})}),Object(n.jsx)("div",{className:"pl-2",children:Object(n.jsx)(o,{score:e.player.score})}),e.paused&&Object(n.jsx)("span",{className:"text-red-500 pl-2 font-bold",children:e.player.points})]}),Object(n.jsx)("div",{className:"-space-x-12 flex flex-wrap items-center playingCards faceImages simpleCards",children:t})]})};var h=function(e){for(var r=[],t=0;t<e.players.length;t++)0!==t&&r.push(Object(n.jsx)(j,{paused:e.paused,player:e.players[t],turn:e.turn},t));return Object(n.jsx)("div",{className:"flex flex-wrap content-center",children:r})},f=function(e,r){var t=e;return t+1>=r?t=0:t+=1,t},v=function(e){var r=Array.from(Array(13).keys()),t=Array.from({length:13},(function(e,r){return r+13})),n=Array.from({length:13},(function(e,r){return r+26})),a=Array.from({length:13},(function(e,r){return r+39})),c="",s=e;return r.includes(e)?c="H":t.includes(e)?(c="D",s-=13):n.includes(e)?(c="C",s-=26):a.includes(e)?(c="S",s-=39):[52,53].includes(e)&&(c="J",s="-1"),0===s?s="A":10===s?s="J":11===s?s="Q":12===s?s="K":-1===s?s=0:s++,{number:s,suit:c}},p=function(e){for(var r,t,n=e.length;0!==n;)t=Math.floor(Math.random()*n),r=e[n-=1],e[n]=e[t],e[t]=r;return e},m=function(e){var r=Array.from(Array(54).keys());r=p(r);for(var t=[],n=0;n<e;n++)t.push({id:"Player "+n,score:0,hand:c(5),turn:n,points:0,lastDrawPile:0});for(var a=0;a<t.length;a++)t[a].points=g(t[a].hand);function c(e){for(var t=[],n=0;n<e;n++)t.push(r.pop());return t}return{players:t,deck:r}},x=function(e,r){return Math.floor(Math.random()*r)+e},O={0:0,A:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:10,Q:10,K:10},g=function(e){for(var r=0,t=0;t<e.length;t++){var n=v(e[t]);r+=O[n.number]}return r},y=function(e,r,t){var n,a=function(e){for(var r=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0]],t={J:0,H:1,D:2,C:3,S:4},n={0:0,A:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:11,Q:12,K:13},a=0;a<e.length;a++){var c=v(e[a]),s=t[c.suit],i=n[c.number];r[s][i]++}return r}(e);switch(t){case 0:({cards:[e[x(0,e.length)]],drawPile:2});break;case 1:({cards:N(e,a),drawPile:2});break;case 2:var c=k(e);0===c.length&&(c=[e[x(0,e.length)]]),{cards:c,drawPile:2};break;default:({cards:[e[0]],drawPile:2})}var s=N(e,a),i=k(e),l=g(s),d=g(i);n=l>=d?s:i;var u=2;if(r.length>0){var o=r[r.length-1],b=v(o),j=O[b.number],h=e.filter((function(e){return n.indexOf(e)<0})),f=N(h=h.push(o),a),p=k(h);f.length>=2&&f.includes(o)?(console.log("set lengths match: "+f.length),u=1):p.length>=3&&f.includes(o)?(console.log("run lengths match: "+p.length),u=1):j<4&&(console.log("topCardValue match: "+j),u=1)}return{cards:n,drawPile:u}};function k(e){for(var r=[],t=[],n=[],a=[],c=[],s=0;s<e.length;s++){switch(v(e[s]).suit){case"H":r.push(e[s]);break;case"D":t.push(e[s]);break;case"C":n.push(e[s]);break;case"S":a.push(e[s]);break;case"J":c.push(e[s])}}var i=[r,t,n,a];i=i.sort((function(e,r){return r.length-e.length}));for(var l=[],d=0;d<i.length;d++){var u=i[d].concat(c);if(C(i[d])){l=i[d];break}if(1===c.length&&C(u)){l=u;break}if(2===c.length&&C(i[d].concat(c[0]))){l=i[d].concat(c[0]);break}if(2===c.length&&C(u)){l=u;break}}if(l.length<=1){var o=v(e[0]),b=O[o.number];l=[e[0]];for(var j=1;j<e.length;j++){var h=v(e[j]),f=O[h.number];f>b&&(b=f,l=[e[j]])}}return l}function N(e,r){for(var t=r.reduce((function(e,r){return e.map((function(e,t){return r[t]+e}))})),n=Math.max.apply(Math,t),a=0,c=0;c<t.length;c++)t[c]===n&&(a=c);for(var s=[],i={0:0,A:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:11,Q:12,K:13},l=0;l<e.length;l++)i[v(e[l]).number]===a&&s.push(e[l]);return s}var C=function(e){for(var r={0:0,A:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:11,Q:12,K:13},t=[],n=0;n<e.length;n++){var a=v(e[n]);a.number=r[a.number],t.push(a)}var c=!1,s=!1;t.length>=2&&(c=function(e){for(var r=!0,t=e[0].number,n=0;n<e.length;n++)if(0!==e[n].number&&e[n].number!==t){r=!1;break}return r}(t)),t.length>=3&&(s=function(e){for(var r=!0,t="",n=0;n<e.length;n++)if("J"!==e[n].suit){t=e[n].suit;break}for(var a=[],c=0,s=0;s<e.length;s++)if("J"===e[s].suit)c++;else{if(e[s].suit!==t&&"J"!==e[s].suit){r=!1;break}a.push(e[s].number)}a=a.sort((function(e,r){return e-r}));for(var i=1;i<a.length;i++){var l=a[i]-a[i-1];if(l>=4||3===l&&c<2||2===l&&c<1){r=!1;break}}return r}(t));var i=!1;return(1===e.length||c||s)&&(i=!0),i};var w=function(e){var r=Object(a.useState)(!1),t=Object(l.a)(r,2),c=t[0],s=t[1];function i(){e.paused||(s(!c),e.onCardClick(e.card))}var d,u,o=v(e.card),b={H:"hearts",D:"diams",C:"clubs",S:"spades",J:"joker"}[o.suit],j="selectable cursor-pointer card rank-"+o.number+" "+b;switch(52===e.card?j+=" little":53===e.card&&(j+=" big"),j=j.toLowerCase(),o.suit){case"H":d=Object(n.jsx)("div",{className:"suit",children:"\u2665"});break;case"D":d=Object(n.jsx)("div",{className:"suit",children:"\u2666"});break;case"C":d=Object(n.jsx)("div",{className:"suit",children:"\u2663"});break;case"S":d=Object(n.jsx)("div",{className:"suit",children:"\u2660"});break;case"J":d=Object(n.jsx)("div",{className:"suit",children:"Joker"})}return u=c?Object(n.jsx)("strong",{children:Object(n.jsxs)("label",{onClick:function(){return i()},className:j,children:[Object(n.jsx)("div",{className:"rank",children:o.number}),d]})}):Object(n.jsxs)("div",{onClick:function(){return i()},className:j,children:[Object(n.jsx)("div",{className:"rank",children:o.number}),d]}),Object(n.jsx)("div",{className:"playingCards faceImages simpleCards",children:u})};var S=function(e){var r=[];function t(r){e.onCardClick(r)}var a,c=Object(d.a)(e.player.hand);try{for(c.s();!(a=c.n()).done;){var s=a.value;r.push(Object(n.jsx)(w,{paused:e.paused,card:s,onCardClick:function(e){return t(e)}},s))}}catch(i){c.e(i)}finally{c.f()}return Object(n.jsx)("div",{className:"space-x-3 flex items-center justify-center flex-wrap",children:r})};var P=function(){return Object(n.jsx)("div",{children:Object(n.jsx)("button",{className:"px-4 py-1 rounded-md text-white bg-purple-500 hover:bg-purple-600 focus:outline-none",children:"Yaniv"})})};var A=function(){return Object(n.jsx)("div",{children:Object(n.jsx)("button",{className:"px-4 py-1 rounded-md text-white bg-blue-500 hover:bg-blue-600 focus:outline-none",children:"Ready"})})};var D=function(e){return Object(n.jsxs)("div",{className:"flex flex-col",children:[Object(n.jsx)("div",{className:"",children:Object(n.jsx)(S,{selectedCards:e.selectedCards,paused:e.paused,player:e.player,onCardClick:function(r){return function(r){var t=e.selectedCards;t.includes(r)?t.splice(t.indexOf(r),1):t.push(r),e.onCardClick(t,r)}(r)}})}),Object(n.jsxs)("div",{className:"flex items-center justify-center pt-6",children:[e.turn===e.player.turn?Object(n.jsx)("div",{className:"bg-yellow-300",children:Object(n.jsx)(b,{id:e.player.id})}):Object(n.jsx)("div",{className:"",children:Object(n.jsx)(b,{id:e.player.id})}),Object(n.jsx)("span",{className:"pl-2",children:Object(n.jsx)(o,{score:e.player.score})}),e.paused&&Object(n.jsx)("span",{className:"text-red-500 font-bold pl-2",children:e.player.points}),g(e.player.hand)<=5&&!e.paused&&Object(n.jsx)("div",{onClick:function(){e.onYanivClick()},className:"pl-4",children:Object(n.jsx)(P,{})}),e.paused&&Object(n.jsx)("div",{onClick:function(){e.onReadyClick()},className:"pl-4",children:Object(n.jsx)(A,{})})]}),Object(n.jsx)("div",{className:"pt-6 text-red-500",children:e.errorMessage})]})};var J=function(e){function r(){e.paused||void 0===e.discardPile||0===e.discardPile.length||e.onDiscardPileClick()}var t,a,c,s,i;if(e.discardPile.length>0){var l=e.lastPlayedCards,d={H:"hearts",D:"diams",C:"clubs",S:"spades",J:"joker"};i=[];for(var u=0;u<l.length;u++){var o=v(l[u]);switch(t=d[o.suit],a="discard card rank-"+o.number+" "+t,52===l[u]?a+=" little":53===l[u]&&(a+=" big"),a=a.toLowerCase(),o.suit){case"H":c=Object(n.jsx)("div",{className:"suit",children:"\u2665"});break;case"D":c=Object(n.jsx)("div",{className:"suit",children:"\u2666"});break;case"C":c=Object(n.jsx)("div",{className:"suit",children:"\u2663"});break;case"S":c=Object(n.jsx)("div",{className:"suit",children:"\u2660"});break;case"J":c=Object(n.jsx)("div",{className:"suit",children:"Joker"})}u===l.length-1?(a+=" selectable cursor-pointer",s=Object(n.jsxs)("div",{onClick:r,className:a,children:[Object(n.jsx)("div",{className:"rank",children:o.number}),c]},l[u])):s=Object(n.jsxs)("div",{className:a,children:[Object(n.jsx)("div",{className:"rank",children:o.number}),c]},l[u]),i.push(s)}}else i=Object(n.jsx)("div",{className:"flex items-center justify-center text-sm w-16 h-20 mx-3 rounded-md bg-white border-4 border-gray-200 focus:outline-none",children:"discard pile"});return Object(n.jsx)("div",{className:"-space-x-12",children:i})};var I=function(e){function r(){e.onDrawStackClick()}var t;return t=e.drawStack.length>0?Object(n.jsx)("div",{onClick:r,className:"selectable cursor-pointer card back",children:"*"}):Object(n.jsx)("div",{onClick:r,className:"selectable cursor-pointer text-md flex items-center justify-center w-16 h-20 mx-3 rounded-md bg-white border-4 border-gray-200 hover:border-gray-300 focus:outline-none",children:"shuffle"}),Object(n.jsx)("div",{children:t})};var M=function(e){return Object(n.jsx)("div",{children:Object(n.jsxs)("div",{className:"space-x-3 flex justify-center align-center items-center playingCards faceImages simpleCards",children:[Object(n.jsx)(I,{onDrawStackClick:function(){e.onDrawStackClick()},drawStack:e.drawStack,paused:e.paused}),Object(n.jsx)(J,{onDiscardPileClick:function(){e.onDiscardPileClick()},discardPile:e.discardPile,paused:e.paused,lastPlayedCards:e.lastPlayedCards})]})})};t(31),t(32);var H=function(){var e=m(4),r=Object(a.useState)(e.players),t=Object(l.a)(r,2),c=t[0],s=t[1],i=Object(a.useState)([]),d=Object(l.a)(i,2),u=d[0],o=d[1],b=Object(a.useState)(e.deck),j=Object(l.a)(b,2),O=j[0],k=j[1],N=Object(a.useState)(x(0,e.players.length)),w=Object(l.a)(N,2),S=w[0],P=w[1],A=Object(a.useState)(""),J=Object(l.a)(A,2),I=J[0],H=J[1],K=Object(a.useState)([]),Q=Object(l.a)(K,2),Y=Q[0],F=Q[1],L=Object(a.useState)(!1),R=Object(l.a)(L,2),z=R[0],B=R[1],V=Object(a.useReducer)((function(e){return e+1}),0),E=Object(l.a)(V,2)[1],T=Object(a.useState)([]),U=Object(l.a)(T,2),G=U[0],W=U[1];function X(e,r){c[0].turn===S?0!==e.length?C(e)?(0===r?($(),q(e,c[S])):(_(),q(e,c[S])),F([])):H("you can't play those cards"):H("you need to select cards to play"):H("not your turn")}function Z(e,r){var t,n,a,i;if(e.length>1){var l=e;t=u.concat(l);for(var d=c.indexOf(r),b=c[d],j=0;j<l.length;j++)b.hand.splice(b.hand.indexOf(l[j]),1);b.points=g(b.hand),(n=c)[d]=b,a=[],i=G.concat(l)}else{(t=u).push(e);var h=c.indexOf(r),f=c[h];f.hand.splice(f.hand.indexOf(e),1),f.points=g(f.hand),(n=c)[h]=f,(a=Y).includes(e)&&a.splice(a.indexOf(e),1),(i=G).push(e)}o(t),s(n),H(""),F(a),W(i),E()}function q(e,r){var t=e;if(t.length>1){var n={0:0,A:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:11,Q:12,K:13};t.sort((function(e,r){return n[v(e).number]-n[v(r).number]}))}var a=u;a=a.concat(t);for(var i=c.indexOf(r),l=c[i],d=0;d<e.length;d++)l.hand.includes(e[d])&&l.hand.splice(l.hand.indexOf(e[d]),1);l.points=g(l.hand);var b=c;b[i]=l,W(t),o(a),s(b),H(""),P(f(S,c.length))}function $(){var e=u;ee(e.pop(),c[S],1),o(e)}function _(){var e=O;ee(e.pop(),c[S],2),k(e)}function ee(e,r,t){var n=c.indexOf(r),a=c[n];a.hand.push(e),a.lastDrawPile=t;var i=c;i[n]=a,s(i)}function re(e){var r=e;if(r.turn===S){for(var t=c,n=!1,a=0;a<t.length;a++)if(t[a]!==r){var i=t[a];i.points>r.points?i.score+=i.points:i.points<=r.points&&!n&&(r.score+=35,n=!0),t[a]=i}for(var l=0;l<t.length;l++)100!==t[l].score&&200!==t[l].score||(t[l].score=t[l].score/2);s(t),B(!0)}else H("not your turn")}return Object(a.useEffect)((function(){var e=null;return z||0===S?clearInterval(e):e=setInterval((function(){(function(){if(0!==O.length){var e=c[S];if(e.points<=5)re(e);else{var r=e.hand,t=y(r,u,3);1===t.drawPile?$():_(),q(t.cards,e)}}else H("draw stack is empty")})()}),1500),function(){return clearInterval(e)}})),Object(n.jsxs)("div",{className:"flex items-center justify-center flex-col bg-white",children:[Object(n.jsx)("div",{className:"border-b-2 py-8",children:Object(n.jsx)(h,{paused:z,turn:S,players:c})}),Object(n.jsx)("div",{className:"border-b-2 py-8",children:Object(n.jsx)(M,{discardPile:u,drawStack:O,onDiscardPileClick:function(){0!==u.length&&X(Y,0)},onDrawStackClick:function(){return function(){if(0===O.length){var e=u,r=e.pop();return e=p(e),k(e),void o([r])}X(Y,1)}()},paused:z,lastPlayedCards:G})}),Object(n.jsx)("div",{className:"py-8",children:Object(n.jsx)(D,{player:c[0],errorMessage:I,turn:S,onCardClick:function(e,r){return function(e,r){if(u.length>0){var t=u[u.length-1];if(v(t).number===v(r).number&&S===f(c[0].turn)&&r===c[0].hand[c[0].hand.length-1]&&2===c[0].lastDrawPile)return void Z(r,c[0]);if(G.length>=3&&t+1===r&&"K"!==v(t).number)return void Z(r,c[0]);if(G.length+e.length===4){for(var n=G.concat(e),a=!0,s=v(n[0]).number,i=1;i<n.length;i++)if(v(n[i]).number!==s){a=!1;break}if(a)return void Z(e,c[0])}}F(e)}(e,r)},onYanivClick:function(){re(c[0])},onReadyClick:function(){return function(){for(var e=!1,r=0;r<c.length;r++)if(c[r].score>200){e=!0;break}for(var t=c,n=m(4),a=0;a<n.players.length;a++)t[a].hand=n.players[a].hand,t[a].points=n.players[a].points,e?t[a].score=0:100!==t[a].score&&200!==t[a].score||(t[a].score=t[a].score/2);s(t),o([]),k(n.deck),P(f(S,c.length)),B(!1),F([])}()},selectedCards:Y,paused:z})})]})},K=t(10),Q=(t(35),t(36),t(21));var Y=function(e){var r=K.a.auth();return Object(n.jsx)("div",{className:"p-4",children:Object(n.jsx)("button",{onClick:function(){console.log("do the sign up");var e=new K.a.auth.GoogleAuthProvider;r.signInWithPopup(e)},className:"w-full px-4 py-1 rounded-md text-white bg-indigo-500 hover:bg-indigo-600 focus:outline-none",children:"Sign in to chat"})})},F=t(16),L=t.n(F),R=t(22);var z=function(e){var r=e.message,t=r.text;return r.uid,Object(n.jsx)("div",{className:"px-4 py-1 border-b-1 border-gray-300",children:t})},B=t(23);var V=function(e){var r=K.a.auth(),t=K.a.firestore().collection("messages"),c=t.orderBy("createdAt").limit(25),s=Object(B.a)(c,{idField:"id"}),i=Object(l.a)(s,1)[0],d=Object(a.useState)(""),u=Object(l.a)(d,2),o=u[0],b=u[1],j=function(){var e=Object(R.a)(L.a.mark((function e(n){var a;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),a=r.currentUser.uid,e.next=4,t.add({text:o,createdAt:K.a.firestore.FieldValue.serverTimestamp(),uid:a});case 4:b("");case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();return Object(n.jsxs)("div",{children:[Object(n.jsxs)("div",{className:"bg-indigo-500 p-4 text-white mb-2 w-full",children:["Chat",r.currentUser&&Object(n.jsx)("button",{className:"underline absolute right-4",onClick:function(){return r.signOut()},children:"Logout"})]}),i&&i.map((function(e){return Object(n.jsx)(z,{message:e},e.id)})),Object(n.jsx)("form",{onSubmit:j,className:"p-4 absolute bottom-0 w-full",children:Object(n.jsx)("input",{value:o,onChange:function(e){return b(e.target.value)},className:"p-1 w-full border-2 border-gray-300 focus:ring-indigo-500 focus:border-indigo-500",type:"text",placeholder:"Type a message...",maxLength:"250"})})]})};K.a.apps.length?K.a.app():K.a.initializeApp({apiKey:"AIzaSyAf6lVb7Fa8w2y4YF3CmwuAZdmHzkCXmYY",authDomain:"yaniv-de8e1.firebaseapp.com",projectId:"yaniv-de8e1",storageBucket:"yaniv-de8e1.appspot.com",messagingSenderId:"931495841814",appId:"1:931495841814:web:77bffb9bc7cb69af76e537"});var E=K.a.auth();var T=function(){var e=Object(Q.a)(E),r=Object(l.a)(e,1)[0];return Object(n.jsx)("div",{className:"bg-gray-200 h-screen text-left relative border-r-2 border-indigo-500",children:Object(n.jsx)("section",{children:r?Object(n.jsx)(V,{}):Object(n.jsx)(Y,{})})})};var U=function(){return Object(n.jsxs)("div",{className:"App flex",children:[Object(n.jsx)("div",{className:"w-1/5",children:Object(n.jsx)(T,{})}),Object(n.jsx)("div",{className:"w-4/5 flex items-center justify-center",children:Object(n.jsx)(H,{})})]})};i.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(U,{})}),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.3f7aa828.chunk.js.map