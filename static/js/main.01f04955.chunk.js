(this.webpackJsonpyaniv=this.webpackJsonpyaniv||[]).push([[0],[,,,,,,,,,,,,function(e,r,n){},function(e,r,n){},function(e,r,n){},function(e,r,n){},function(e,r,n){"use strict";n.r(r);var t=n(0),a=n(1),c=n.n(a),s=n(6),i=n.n(s),l=(n(12),n(13),n(2)),d=n(3);var u=function(e){return Object(t.jsx)("li",{children:Object(t.jsx)("div",{className:"card back",children:"*"})})};var o=function(e){return Object(t.jsx)("div",{className:"text-green-600 font-bold",children:e.score})};var h=function(e){return Object(t.jsx)("div",{children:e.id})};var j=function(e){var r,n=[],a=Object(d.a)(e.player.hand);try{for(a.s();!(r=a.n()).done;){var c=r.value;n.push(Object(t.jsx)(u,{card:c},c))}}catch(s){a.e(s)}finally{a.f()}return Object(t.jsxs)("div",{className:"px-8",children:[Object(t.jsxs)("div",{className:"flex items-center justify-center p-3",children:[e.turn===e.player.turn?Object(t.jsx)("div",{className:"bg-yellow-300",children:Object(t.jsx)(h,{id:e.player.id})}):Object(t.jsx)("div",{className:"",children:Object(t.jsx)(h,{id:e.player.id})}),Object(t.jsx)("div",{className:"pl-2",children:Object(t.jsx)(o,{score:e.player.score})}),e.paused&&Object(t.jsx)("span",{className:"text-red-500 pl-2 font-bold",children:e.player.points})]}),Object(t.jsx)("div",{className:"flex flex-wrap items-center playingCards faceImages simpleCards",children:Object(t.jsx)("ul",{className:"hand",children:n})})]})};var f=function(e){for(var r=[],n=0;n<e.players.length;n++)0!==n&&r.push(Object(t.jsx)(j,{paused:e.paused,player:e.players[n],turn:e.turn},n));return Object(t.jsx)("div",{className:"flex flex-wrap content-center",children:r})},b=function(e){var r=Array.from(Array(13).keys()),n=Array.from({length:13},(function(e,r){return r+13})),t=Array.from({length:13},(function(e,r){return r+26})),a=Array.from({length:13},(function(e,r){return r+39})),c="",s=e;return r.includes(e)?c="H":n.includes(e)?(c="D",s-=13):t.includes(e)?(c="C",s-=26):a.includes(e)?(c="S",s-=39):[52,53].includes(e)&&(c="J",s="-1"),0===s?s="A":10===s?s="J":11===s?s="Q":12===s?s="K":-1===s?s=0:s++,{number:s,suit:c}},v=function(e){for(var r,n,t=e.length;0!==t;)n=Math.floor(Math.random()*t),r=e[t-=1],e[t]=e[n],e[n]=r;return e},p=function(e){var r=Array.from(Array(54).keys());r=v(r);for(var n=[],t=0;t<e;t++)n.push({id:"Player "+t,score:0,hand:c(5),turn:t,points:0});for(var a=0;a<n.length;a++)n[a].points=O(n[a].hand);function c(e){for(var n=[],t=0;t<e;t++)n.push(r.pop());return n}return{players:n,deck:r}},x=function(e,r){return Math.floor(Math.random()*r)+e},m={0:0,A:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:10,Q:10,K:10},O=function(e){for(var r=0,n=0;n<e.length;n++){var t=b(e[n]);r+=m[t.number]}return r},g=function(e,r,n){var t,a=function(e){for(var r=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0]],n={J:0,H:1,D:2,C:3,S:4},t={0:0,A:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:11,Q:12,K:13},a=0;a<e.length;a++){var c=b(e[a]),s=n[c.suit],i=t[c.number];r[s][i]++}return r}(e);switch(n){case 0:({cards:[e[x(0,e.length)]],drawPile:2});break;case 1:({cards:y(e,a),drawPile:2});break;case 2:var c=k(e);0===c.length&&(c=[e[x(0,e.length)]]),{cards:c,drawPile:2};break;default:({cards:[e[0]],drawPile:2})}var s=y(e,a),i=k(e),l=O(s),d=O(i);t=l>=d?s:i;var u=2;if(r.length>0){var o=r[r.length-1],h=b(o),j=m[h.number],f=e.filter((function(e){return t.indexOf(e)<0})),v=y(f=f.push(o),a),p=k(f);v.length>=2&&v.includes(o)?(console.log("set lengths match: "+v.length),u=1):p.length>=3&&v.includes(o)?(console.log("run lengths match: "+p.length),u=1):j<4&&(console.log("topCardValue match: "+j),u=1)}return{cards:t,drawPile:u}};function k(e){for(var r=[],n=[],t=[],a=[],c=[],s=0;s<e.length;s++){switch(b(e[s]).suit){case"H":r.push(e[s]);break;case"D":n.push(e[s]);break;case"C":t.push(e[s]);break;case"S":a.push(e[s]);break;case"J":c.push(e[s])}}var i=[r,n,t,a];i=i.sort((function(e,r){return r.length-e.length}));for(var l=[],d=0;d<i.length;d++){var u=i[d].concat(c);if(C(i[d])){l=i[d];break}if(1===c.length&&C(u)){l=u;break}if(2===c.length&&C(i[d].concat(c[0]))){l=i[d].concat(c[0]);break}if(2===c.length&&C(u)){l=u;break}}if(l.length<=1){var o=b(e[0]),h=m[o.number];l=[e[0]];for(var j=1;j<e.length;j++){var f=b(e[j]),v=m[f.number];v>h&&(h=v,l=[e[j]])}}return l}function y(e,r){for(var n=r.reduce((function(e,r){return e.map((function(e,n){return r[n]+e}))})),t=Math.max.apply(Math,n),a=0,c=0;c<n.length;c++)n[c]===t&&(a=c);for(var s=[],i={0:0,A:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:11,Q:12,K:13},l=0;l<e.length;l++)i[b(e[l]).number]===a&&s.push(e[l]);return s}var C=function(e){for(var r={0:0,A:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:11,Q:12,K:13},n=[],t=0;t<e.length;t++){var a=b(e[t]);a.number=r[a.number],n.push(a)}var c=!1,s=!1;n.length>=2&&(c=function(e){for(var r=!0,n=e[0].number,t=0;t<e.length;t++)if(0!==e[t].number&&e[t].number!==n){r=!1;break}return r}(n)),n.length>=3&&(s=function(e){for(var r=!0,n="",t=0;t<e.length;t++)if("J"!==e[t].suit){n=e[t].suit;break}for(var a=[],c=0,s=0;s<e.length;s++)if("J"===e[s].suit)c++;else{if(e[s].suit!==n&&"J"!==e[s].suit){r=!1;break}a.push(e[s].number)}a=a.sort((function(e,r){return e-r}));for(var i=1;i<a.length;i++){var l=a[i]-a[i-1];if(l>=4||3===l&&c<2||2===l&&c<1){r=!1;break}}return r}(n));var i=!1;return(1===e.length||c||s)&&(i=!0),i};var N=function(e){var r=Object(a.useState)(!1),n=Object(l.a)(r,2),c=n[0],s=n[1];function i(){e.paused||(s(!c),e.onCardClick(e.card))}var d,u,o=b(e.card),h={H:"hearts",D:"diams",C:"clubs",S:"spades",J:"joker"}[o.suit],j="selectable cursor-pointer card rank-"+o.number+" "+h;switch(52===e.card?j+=" little":53===e.card&&(j+=" big"),j=j.toLowerCase(),o.suit){case"H":d=Object(t.jsx)("div",{className:"suit",children:"\u2665"});break;case"D":d=Object(t.jsx)("div",{className:"suit",children:"\u2666"});break;case"C":d=Object(t.jsx)("div",{className:"suit",children:"\u2663"});break;case"S":d=Object(t.jsx)("div",{className:"suit",children:"\u2660"});break;case"J":d=Object(t.jsx)("div",{className:"suit",children:"Joker"})}return u=c?Object(t.jsx)("strong",{children:Object(t.jsxs)("label",{onClick:function(){return i()},className:j,children:[Object(t.jsx)("div",{className:"rank",children:o.number}),d]})}):Object(t.jsxs)("div",{onClick:function(){return i()},className:j,children:[Object(t.jsx)("div",{className:"rank",children:o.number}),d]}),Object(t.jsx)("div",{className:"playingCards faceImages simpleCards",children:u})};var w=function(e){var r=[];function n(r){e.onCardClick(r)}var a,c=Object(d.a)(e.player.hand);try{for(c.s();!(a=c.n()).done;){var s=a.value;r.push(Object(t.jsx)(N,{paused:e.paused,card:s,onCardClick:function(e){return n(e)}},s))}}catch(i){c.e(i)}finally{c.f()}return Object(t.jsx)("div",{className:"flex flex-wrap items-center justify-center",children:r})};var S=function(){return Object(t.jsx)("div",{children:Object(t.jsx)("button",{className:"px-4 py-1 rounded-md text-white bg-purple-500 hover:bg-purple-600 focus:outline-none",children:"Yaniv"})})};var P=function(){return Object(t.jsx)("div",{children:Object(t.jsx)("button",{className:"px-4 py-1 rounded-md text-white bg-blue-500 hover:bg-blue-600 focus:outline-none",children:"Ready"})})};var J=function(e){return Object(t.jsxs)("div",{className:"flex flex-col",children:[Object(t.jsx)("div",{className:"flex items-center justify-center",children:Object(t.jsx)(w,{selectedCards:e.selectedCards,paused:e.paused,player:e.player,onCardClick:function(r){return function(r){var n=e.selectedCards;n.includes(r)?n.splice(n.indexOf(r),1):n.push(r),e.onCardClick(n,r)}(r)}})}),Object(t.jsxs)("div",{className:"flex items-center justify-center pt-6",children:[e.turn===e.player.turn?Object(t.jsx)("div",{className:"bg-yellow-300",children:Object(t.jsx)(h,{id:e.player.id})}):Object(t.jsx)("div",{className:"",children:Object(t.jsx)(h,{id:e.player.id})}),Object(t.jsx)("span",{className:"pl-2",children:Object(t.jsx)(o,{score:e.player.score})}),e.paused&&Object(t.jsx)("span",{className:"text-red-500 font-bold pl-2",children:e.player.points}),O(e.player.hand)<=5&&!e.paused&&Object(t.jsx)("div",{onClick:function(){e.onYanivClick()},className:"pl-4",children:Object(t.jsx)(S,{})}),e.paused&&Object(t.jsx)("div",{onClick:function(){e.onReadyClick()},className:"pl-4",children:Object(t.jsx)(P,{})})]}),Object(t.jsx)("div",{className:"pt-6 text-red-500",children:e.errorMessage})]})};var D=function(e){var r,n,a,c,s;if(console.log("discard pile"),e.discardPile.length>0){switch(n={H:"hearts",D:"diams",C:"clubs",S:"spades",J:"joker"}[(r=b(e.discardPile[e.discardPile.length-1])).suit],a="selectable cursor-pointer card rank-"+r.number+" "+n,52===e.discardPile[e.discardPile.length-1]?a+=" little":53===e.discardPile[e.discardPile.length-1]&&(a+=" big"),a=a.toLowerCase(),r.suit){case"H":c=Object(t.jsx)("div",{className:"suit",children:"\u2665"});break;case"D":c=Object(t.jsx)("div",{className:"suit",children:"\u2666"});break;case"C":c=Object(t.jsx)("div",{className:"suit",children:"\u2663"});break;case"S":c=Object(t.jsx)("div",{className:"suit",children:"\u2660"});break;case"J":c=Object(t.jsx)("div",{className:"suit",children:"Joker"})}s=Object(t.jsxs)("div",{onClick:function(){e.paused||void 0===e.discardPile||0===e.discardPile.length||e.onDiscardPileClick()},className:a,children:[Object(t.jsx)("div",{className:"rank",children:r.number}),c]})}else s=Object(t.jsx)("div",{className:"flex items-center justify-center text-sm w-16 h-20 mx-3 rounded-md bg-white border-4 border-gray-200 focus:outline-none",children:"discard pile"});return Object(t.jsx)("div",{className:"playingCards faceImages simpleCards",children:s})};var A=function(e){function r(){e.onDrawStackClick()}var n;return n=e.drawStack.length>0?Object(t.jsx)("div",{onClick:r,className:"selectable cursor-pointer card back",children:"*"}):Object(t.jsx)("div",{onClick:r,className:"selectable cursor-pointer text-md flex items-center justify-center w-16 h-20 mx-3 rounded-md bg-white border-4 border-gray-200 hover:border-gray-300 focus:outline-none",children:"shuffle"}),Object(t.jsx)("div",{className:"playingCards faceImages simpleCards",children:n})};var M=function(e){return Object(t.jsx)("div",{children:Object(t.jsxs)("div",{className:"flex justify-center align-center items-center",children:[Object(t.jsx)(D,{onDiscardPileClick:function(){e.onDiscardPileClick()},discardPile:e.discardPile,paused:e.paused}),Object(t.jsx)(A,{onDrawStackClick:function(){e.onDrawStackClick()},drawStack:e.drawStack,paused:e.paused})]})})};n(14),n(15);var I=function(){var e=p(4),r=Object(a.useState)(e.players),n=Object(l.a)(r,2),c=n[0],s=n[1],i=Object(a.useState)([]),d=Object(l.a)(i,2),u=d[0],o=d[1],h=Object(a.useState)(e.deck),j=Object(l.a)(h,2),m=j[0],k=j[1],y=Object(a.useState)(x(0,e.players.length)),N=Object(l.a)(y,2),w=N[0],S=N[1],P=Object(a.useState)(""),D=Object(l.a)(P,2),A=D[0],I=D[1],H=Object(a.useState)([]),K=Object(l.a)(H,2),Q=K[0],R=K[1],Y=Object(a.useState)(!1),E=Object(l.a)(Y,2),L=E[0],B=E[1],V=Object(a.useReducer)((function(e){return e+1}),0),q=Object(l.a)(V,2)[1];function z(e,r){c[0].turn===w?0!==e.length?C(e)?(0===r?(T(),G(e,c[w])):(U(),G(e,c[w])),R([])):I("you can't play those cards"):I("you need to select cards to play"):I("not your turn")}function F(e,r){if(u.length>0){var n=u[u.length-1];if(b(n).number===b(r).number&&w!==c[0].turn)return void function(e,r){var n=u;n.push(e);var t=c.indexOf(r),a=c[t];a.hand.splice(a.hand.indexOf(e),1),a.points=O(a.hand);var i=c;i[t]=a;var l=Q;l.includes(e)&&l.splice(l.indexOf(e),1);o(n),s(i),I(""),R(l),q()}(r,c[0])}R(e)}function G(e,r){var n=e;if(e.length>1)for(var t=Math.max.apply(Math,e.map((function(e){return O([e])}))),a=0;a<n.length;a++)if(O([n[a]])===t){n.push(n.splice(a,1)[0]);break}var i=u;i=i.concat(n);for(var l=c.indexOf(r),d=c[l],h=0;h<e.length;h++)d.hand.includes(e[h])&&d.hand.splice(d.hand.indexOf(e[h]),1);d.points=O(d.hand);var j=c;j[l]=d,o(i),s(j),I(""),S(Z())}function T(){var e=u;W(e.pop(),c[w]),o(e)}function U(){var e=m;W(e.pop(),c[w]),k(e)}function W(e,r){var n=c.indexOf(r),t=c[n];t.hand.push(e);var a=c;a[n]=t,s(a)}function X(e){var r=e;if(r.turn===w){for(var n=c,t=!1,a=0;a<n.length;a++)if(n[a]!==r){var i=n[a];i.points>r.points?i.score+=i.points:i.points<=r.points&&!t&&(r.score+=35,t=!0),n[a]=i}for(var l=0;l<n.length;l++)100!==n[l].score&&200!==n[l].score||(n[l].score=n[l].score/2);s(n),B(!0)}else I("not your turn")}function Z(){var e=w;return e+1>=c.length?e=0:e+=1,e}return Object(a.useEffect)((function(){var e=null;return L||0===w?clearInterval(e):e=setInterval((function(){(function(){if(0!==m.length){var e=c[w];if(e.points<=5)return clearInterval(),void X(e);var r=e.hand,n=g(r,u,3);1===n.drawPile?T():U(),G(n.cards,e)}else I("draw stack is empty")})()}),3e3),function(){return clearInterval(e)}})),Object(t.jsxs)("div",{className:"flex items-center justify-center flex-col bg-white",children:[Object(t.jsx)("div",{className:"border-b-2 p-8",children:Object(t.jsx)(f,{paused:L,turn:w,players:c})}),Object(t.jsx)("div",{className:"border-b-2 p-8",children:Object(t.jsx)(M,{discardPile:u,drawStack:m,onDiscardPileClick:function(){0!==u.length&&z(Q,0)},onDrawStackClick:function(){return function(){if(0===m.length){var e=u,r=e.pop();return e=v(e),k(e),void o([r])}z(Q,1)}()},paused:L})}),Object(t.jsx)("div",{className:"p-8",children:Object(t.jsx)(J,{player:c[0],errorMessage:A,turn:w,onCardClick:function(e,r){return F(e,r)},onYanivClick:function(){X(c[0])},onReadyClick:function(){return function(){for(var e=!1,r=0;r<c.length;r++)if(c[r].score>200){e=!0;break}for(var n=c,t=p(4),a=0;a<t.players.length;a++)n[a].hand=t.players[a].hand,n[a].points=t.players[a].points,e?n[a].score=0:100!==n[a].score&&200!==n[a].score||(n[a].score=n[a].score/2);s(n),o([]),k(t.deck),S(Z()),B(!1),R([])}()},selectedCards:Q,paused:L})})]})};var H=function(){return Object(t.jsx)("div",{className:"App",children:Object(t.jsx)(I,{})})};i.a.render(Object(t.jsx)(c.a.StrictMode,{children:Object(t.jsx)(H,{})}),document.getElementById("root"))}],[[16,1,2]]]);
//# sourceMappingURL=main.01f04955.chunk.js.map